{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 41,
  "summary": "Build “KarigarFlow – Jewellery Order Management System”, a production-ready cloud/PWA web app for jewellery wholesale order intake via daily Excel/PDF uploads, parsing and mapping design codes to master designs, karigar-wise dashboards, CO highlighting, exports, offline-first sync, and role-based access using React PWA + Supabase.",
  "architectural_notes": [
    "Frontend: React with PWA (offline-first, installable)",
    "Backend: Supabase (PostgreSQL + Auth) with role-based access and RLS",
    "Data ingestion must support Excel parsing and PDF table extraction as input sources",
    "Offline sync requires local persistence + deduplication to prevent duplicate uploads",
    "Auth/setup requirement: first authenticated user is treated as initial Admin; Admin then creates other user profiles (Staff/Karigar) within the app",
    "Excel ingestion requires installing and wiring an Excel parsing library in the frontend (e.g., SheetJS) so Staff/Admin uploads can parse .xlsx and map to the existing ingestion pipeline.",
    "Add a lightweight backend reachability/health check and surface it in the UI as an online/offline status indicator (should handle canister-stopped/unreachable states).",
    "Project backend is Supabase (Postgres + Auth); do not use Internet Computer canisters/IC actors or icp0.io endpoints in the production bootstrap flow.",
    "Orders must automatically derive/assign karigar/factory name from Master Design Excel mappings by matching design_code (and generic_name where applicable) during ingestion/reprocessing; do not require manual assignment.",
    "Karigar assignment during PDF order ingestion must match the user’s expected behavior shown in the provided PDF: orders should be assigned karigar based on design_code-to-karigar mapping (as represented in the PDF), and the UI must support viewing/filtering orders karigar-wise accordingly."
  ],
  "known_issues": [
    "Order parsing is still not active/working in the deployed app (ingestion/parsing flow not functioning)",
    "Excel upload/parsing path is not configured in the deployed app (missing Excel parsing library/wiring), causing 'Excel file parsing is not yet fully configured' parse errors.",
    "App page is stuck on \"Loading profile\" (profile/auth bootstrap appears to hang), blocking access/testing.",
    "Ingestion currently errors or blocks when some uploaded order rows contain design_codes that don't match Master Design mappings; it should instead ingest and surface those rows under Unmapped Codes.",
    "Admin dashboard navigation/menu (Dashboard/Master Designs/Users/Ingest Order/Unmapped Codes) does not display properly on laptop/PC in the deployed app.",
    "After latest deployment (v5), app is still stuck on the “Loading profile…” screen (bootstrap hang persists).",
    "Profile load fails with IC replica rejection because backend canister is stopped (Reject code 5 / IC0508) when calling `getCallerUserProfile` on canister 6wepb-taaaa-aaaan-q2pcq-cai.",
    "After clicking any tab, app gets stuck on “Loading profile…” (navigation triggers bootstrap hang/loading loop).",
    "Orders/totals show karigar as “Unassigned” even when Master Design PDF mappings exist; automatic karigar assignment from design_code mapping is not being applied/displayed.",
    "PDF order karigar assignment logic does not match the user’s expectation from the provided PDF (user expects karigar assignment per design_code mapping and karigar-wise filtered display); current assignment behavior is perceived as incorrect."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-implement-role-based-authentication-using-internet-identity-with-three-application-roles-admin-staff-karigar-and-enforce-authorization-across-the-app-ui-backend-so-that-karigars-can-only-access-their-own-assigned-orders-staff-can-upload-and-view-orders-and-admin-has-full-access",
      "title": "Implement role-based authentication using Internet Identity with three application roles (Admin, Staff, Karigar) and enforce authorization across the app (UI + backend) so that Karigars can only access their own assigned orders, Staff can upload and view orders, and Admin has full access.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-add-master-design-import-and-management-ui-admin-can-upload-a-master-design-file-pdf-and-or-excel-and-or-manually-add-edit-mappings-of-design-code-to-generic-name-and-karigar-name-the-system-must-report-duplicates-and-allow-updates-without-creating-conflicting-design-code-entries",
      "title": "Add Master Design import and management UI: Admin can upload a Master Design file (PDF and/or Excel) and/or manually add/edit mappings of design_code to generic_name and karigar_name; the system must report duplicates and allow updates without creating conflicting design_code entries.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-daily-order-ingestion-from-uploaded-files-pdf-and-or-excel-parse-rows-to-extract-order-no-order-type-design-design-code-weight-size-qty-remarks-then-auto-map-generic-name-and-karigar-from-master-designs-persist-to-backend-and-flag-any-unmapped-design-codes-for-review",
      "title": "Implement Daily Order ingestion from uploaded files (PDF and/or Excel): parse rows to extract Order No, Order Type, Design (design_code), Weight, Size, Qty, Remarks; then auto-map Generic Name and Karigar from Master Designs; persist to backend; and flag any unmapped design codes for review.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-detect-and-highlight-customer-orders-if-order-type-contains-co-set-is-customer-order-true-during-ingestion-and-visually-highlight-those-rows-consistently-across-tables-and-exports",
      "title": "Detect and highlight Customer Orders: if Order Type contains “CO”, set is_customer_order=true during ingestion and visually highlight those rows consistently across tables and exports.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-build-dashboards-and-order-list-views-per-role-with-required-metrics-grouping-sorting-and-filters-admin-dashboard-totals-co-totals-karigar-wise-totals-date-filter-staff-dashboard-upload-view-filter-export-and-karigar-dashboard-only-assigned-orders-totals-status-updates",
      "title": "Build dashboards and order list views per role with required metrics, grouping, sorting, and filters: Admin dashboard (totals, CO totals, karigar-wise totals, date filter), Staff dashboard (upload + view/filter/export), and Karigar dashboard (only assigned orders, totals, status updates).",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-export-features-for-admin-staff-export-karigar-wise-sheets-co-only-exports-daily-sheet-exports-and-cumulative-exports-using-the-currently-applied-filters-and-including-required-columns",
      "title": "Implement export features for Admin/Staff: export karigar-wise sheets, CO-only exports, daily sheet exports, and cumulative exports, using the currently applied filters and including required columns.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-add-offline-first-pwa-behavior-app-is-installable-works-on-mobile-supports-offline-viewing-of-previously-loaded-data-supports-offline-ingestion-queues-for-uploads-syncs-when-online-and-prevents-duplicate-uploads",
      "title": "Add offline-first PWA behavior: app is installable, works on mobile, supports offline viewing of previously loaded data, supports offline ingestion queues for uploads, syncs when online, and prevents duplicate uploads.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-an-unmapped-design-codes-workflow-provide-a-dedicated-view-admin-staff-listing-unmapped-rows-design-codes-found-during-ingestion-allow-adding-a-master-mapping-for-those-codes-and-reprocessing-affected-orders-to-fill-generic-name-and-karigar-name",
      "title": "Implement an 'Unmapped Design Codes' workflow: provide a dedicated view (Admin/Staff) listing unmapped rows/design codes found during ingestion, allow adding a master mapping for those codes, and reprocessing affected orders to fill generic_name and karigar_name.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-consistent-modern-jewellery-business-visual-theme-across-the-ui-layout-typography-colors-spacing-including-light-and-dark-mode-without-using-a-blue-purple-primary-palette",
      "title": "Apply a consistent, modern jewellery-business visual theme across the UI (layout, typography, colors, spacing) including light and dark mode, without using a blue/purple primary palette.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-create-basic-production-hardening-input-validation-for-uploads-parsing-clear-error-states-for-failed-parses-sync-auth-and-an-in-app-setup-path-for-initial-admin-creation-configuration",
      "title": "Create basic production hardening: input validation for uploads/parsing, clear error states for failed parses/sync/auth, and an in-app setup path for initial Admin creation/configuration.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-working-file-parsing-so-that-the-staff-admin-ingestion-flow-can-parse-uploaded-order-files-instead-of-throwing-parsing-not-yet-implemented-errors",
      "title": "Implement working file parsing so that the Staff/Admin ingestion flow can parse uploaded order files instead of throwing 'parsing not yet implemented' errors.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-change-the-user-provisioning-flow-so-the-first-login-is-admin-and-only-admin-can-create-profiles-for-other-logins-staff-karigar-rather-than-each-user-selecting-their-own-role-on-first-login",
      "title": "Change the user provisioning flow so the first login is Admin, and only Admin can create profiles for other logins (Staff/Karigar), rather than each user selecting their own role on first login.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-real-excel-parsing-for-order-ingestion-so-that-uploading-xlsx-xls-files-on-the-staff-admin-ingest-orders-page-parses-rows-into-orders-instead-of-throwing-the-current-excel-file-parsing-is-not-yet-fully-configured-error",
      "title": "Implement real Excel parsing for order ingestion so that uploading .xlsx/.xls files on the Staff/Admin \"Ingest Orders\" page parses rows into Orders instead of throwing the current \"Excel file parsing is not yet fully configured\" error.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-real-excel-parsing-for-master-designs-import-so-that-uploading-xlsx-xls-files-in-the-admin-import-master-designs-dialog-parses-rows-into-design-code-generic-name-karigar-name-entries-instead-of-throwing-the-current-excel-file-parsing-is-not-yet-fully-configured-error",
      "title": "Implement real Excel parsing for Master Designs import so that uploading .xlsx/.xls files in the Admin \"Import Master Designs\" dialog parses rows into (design_code -> {generic_name, karigar_name}) entries instead of throwing the current \"Excel file parsing is not yet fully configured\" error.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-add-and-wire-an-excel-workbook-parsing-dependency-in-the-frontend-build-so-that-the-excel-parsing-implementations-can-read-xlsx-xls-files-in-the-browser-and-remove-the-current-hardcoded-excel-file-parsing-is-not-yet-fully-configured-throws-from-the-excel-code-paths",
      "title": "Add and wire an Excel workbook parsing dependency in the frontend build so that the Excel parsing implementations can read .xlsx/.xls files in the browser, and remove the current hardcoded \"Excel file parsing is not yet fully configured...\" throws from the Excel code paths.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-make-frontend-bootstrap-resilient-if-profile-admin-queries-fail-e-g-due-to-authorization-init-issues-the-app-must-not-remain-indefinitely-on-the-loading-profile-screen-add-a-clear-error-state-in-frontend-src-app-tsx-for-the-profile-bootstrap-step-that-displays-an-english-error-message-includes-a-retry-action-and-includes-a-logout-clear-session-action",
      "title": "Make frontend bootstrap resilient: if profile/admin queries fail (e.g., due to authorization/init issues), the app must not remain indefinitely on the “Loading profile…” screen. Add a clear error state in `frontend/src/App.tsx` for the profile bootstrap step that displays an English error message, includes a Retry action, and includes a Logout/Clear-session action.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-add-minimal-diagnostics-to-help-identify-the-cause-of-bootstrap-hangs-log-to-console-distinct-non-sensitive-error-messages-when-profile-fetch-admin-check-or-access-control-initialization-fails-and-ensure-the-error-boundary-fallback-ux-remains-usable",
      "title": "Add minimal diagnostics to help identify the cause of bootstrap hangs: log (to console) distinct, non-sensitive error messages when profile fetch, admin-check, or access-control initialization fails, and ensure the error boundary/fallback UX remains usable.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-runtime-ui-crash-caused-by-shadcn-radix-select-items-using-an-empty-string-value-e-g-in-ordersfiltersbar-so-pages-render-normally-on-desktop-and-mobile-without-triggering-the-global-error-boundary",
      "title": "Fix the runtime UI crash caused by Shadcn/Radix Select items using an empty string value (e.g., in OrdersFiltersBar), so pages render normally on desktop and mobile without triggering the global error boundary.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-admin-dashboard-navigation-rendering-on-laptop-pc-so-the-top-navigation-items-dashboard-master-designs-users-ingest-orders-unmapped-codes-are-consistently-visible-and-usable-on-desktop-browsers-when-opening-the-app-via-a-link",
      "title": "Fix Admin dashboard navigation rendering on laptop/PC so the top navigation items (Dashboard, Master Designs, Users, Ingest Orders, Unmapped Codes) are consistently visible and usable on desktop browsers when opening the app via a link.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-make-order-ingestion-resilient-to-rows-whose-design-code-does-not-match-master-designs-parse-and-accept-those-rows-upload-them-without-failing-the-whole-file-and-show-them-separately-in-the-ingestion-preview-so-staff-admin-can-clearly-see-which-rows-are-unmapped",
      "title": "Make order ingestion resilient to rows whose design code does not match Master Designs: parse and accept those rows, upload them without failing the whole file, and show them separately in the ingestion preview so staff/admin can clearly see which rows are unmapped.",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-prevent-the-app-from-getting-stuck-on-the-loading-profile-screen-when-backend-actor-creation-fails-e-g-initializeaccesscontrolwithsecret-throws-introduce-a-new-non-immutable-hook-that-creates-the-actor-safely-exposes-actor-creation-error-state-and-ensures-the-app-can-surface-a-bootstraperrorscreen-instead-of-hanging",
      "title": "Prevent the app from getting stuck on the “Loading profile…” screen when backend actor creation fails (e.g., `_initializeAccessControlWithSecret(...)` throws). Introduce a new non-immutable hook that creates the actor safely, exposes actor creation error state, and ensures the app can surface a BootstrapErrorScreen instead of hanging.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-actor-initialization-flow-so-initializeaccesscontrolwithsecret-cannot-block-app-startup-if-the-caffeineadmintoken-secret-is-missing-empty-skip-calling-initializeaccesscontrolwithsecret-if-the-call-throws-catch-the-error-log-a-non-sensitive-diagnostic-message-to-the-console-and-still-return-a-usable-actor-instance-so-downstream-queries-can-run-and-return-proper-authorization-errors",
      "title": "Update the actor initialization flow so `_initializeAccessControlWithSecret` cannot block app startup: if the `caffeineAdminToken` secret is missing/empty, skip calling `_initializeAccessControlWithSecret`; if the call throws, catch the error, log a non-sensitive diagnostic message to the console, and still return a usable actor instance so downstream queries can run and return proper authorization errors.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-refactor-bootstrap-queries-to-use-the-new-safe-actor-hook-and-to-treat-actor-not-available-as-an-error-state-rather-than-an-indefinite-loading-state-ensure-usecurrentuser-and-useiscalleradmin-via-frontend-src-hooks-usequeries-ts-can-surface-actor-init-errors-to-frontend-src-app-tsx-so-the-existing-bootstrap-error-ui-is-shown",
      "title": "Refactor bootstrap queries to use the new safe-actor hook and to treat “actor not available” as an error state rather than an indefinite loading state. Ensure `useCurrentUser` and `useIsCallerAdmin` (via `frontend/src/hooks/useQueries.ts`) can surface actor/init errors to `frontend/src/App.tsx` so the existing bootstrap error UI is shown.",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-add-minimal-distinct-non-sensitive-console-diagnostics-for-each-bootstrap-failure-point-relevant-to-the-hang-1-actor-creation-2-access-control-initialization-attempt-3-getcalleruserprofile-failure-4-iscalleradmin-failure-diagnostics-must-help-differentiate-no-token-token-rejected-and-unauthorized-caller-not-permitted-cases-without-printing-secrets",
      "title": "Add minimal, distinct, non-sensitive console diagnostics for each bootstrap failure point relevant to the hang: (1) actor creation, (2) access-control initialization attempt, (3) `getCallerUserProfile` failure, (4) `isCallerAdmin` failure. Diagnostics must help differentiate “no token”, “token rejected”, and “unauthorized/caller not permitted” cases without printing secrets.",
      "reqIds": [
        "REQ-27"
      ],
      "version": 1
    },
    {
      "id": "feature-when-bootstrap-fails-because-the-replica-rejects-calls-due-to-the-backend-canister-being-stopped-e-g-reject-code-5-ic0508-with-text-like-canister-id-is-stopped-and-therefore-does-not-have-a-callcontextmanager-show-a-specific-user-friendly-english-error-explanation-on-the-existing-bootstraperrorscreen-instead-of-only-dumping-the-raw-error-message",
      "title": "When bootstrap fails because the replica rejects calls due to the backend canister being stopped (e.g., Reject code 5 / IC0508 with text like “Canister <id> is stopped and therefore does not have a CallContextManager”), show a specific, user-friendly English error explanation on the existing `BootstrapErrorScreen` instead of only dumping the raw error message.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-copy-error-details-action-to-frontend-src-components-auth-bootstraperrorscreen-tsx-that-copies-the-full-raw-error-string-to-the-clipboard-so-users-can-share-diagnostics-e-g-request-id-reject-code-canister-id-without-manually-selecting-text",
      "title": "Add a “Copy error details” action to `frontend/src/components/auth/BootstrapErrorScreen.tsx` that copies the full raw error string to the clipboard so users can share diagnostics (e.g., request ID / reject code / canister id) without manually selecting text.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-enhance-console-diagnostics-during-bootstrap-failures-to-explicitly-classify-and-log-the-canister-stopped-condition-without-printing-secrets-so-it-is-easy-to-distinguish-from-authorization-token-issues",
      "title": "Enhance console diagnostics during bootstrap failures to explicitly classify and log the “canister stopped” condition (without printing secrets), so it is easy to distinguish from authorization/token issues.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    },
    {
      "id": "feature-update-frontend-src-components-auth-bootstraperrorscreen-tsx-so-the-raw-technical-error-string-is-not-shown-by-default-instead-show-a-short-english-explanation-including-the-stopped-canister-friendly-message-when-detected-and-place-the-full-raw-error-details-behind-an-explicit-user-action-e-g-show-error-details-collapsible-panel-keep-retry-and-logout-actions-clearly-visible",
      "title": "Update `frontend/src/components/auth/BootstrapErrorScreen.tsx` so the raw technical error string is not shown by default. Instead, show a short English explanation (including the stopped-canister friendly message when detected) and place the full raw error details behind an explicit user action (e.g., “Show error details” / collapsible panel). Keep “Retry” and “Logout” actions clearly visible.",
      "reqIds": [
        "REQ-31"
      ],
      "version": 1
    },
    {
      "id": "feature-enhance-stopped-canister-error-classification-and-messaging-so-that-when-the-error-indicates-a-stopped-backend-canister-e-g-contains-ic0508-or-is-stopped-the-ui-message-explicitly-states-the-service-is-temporarily-unavailable-because-the-backend-is-stopped-and-suggests-trying-again-later-where-possible-extract-and-display-the-canister-id-in-the-user-friendly-message-without-exposing-sensitive-data",
      "title": "Enhance stopped-canister error classification and messaging so that when the error indicates a stopped backend canister (e.g., contains “IC0508” or “is stopped”), the UI message explicitly states the service is temporarily unavailable because the backend is stopped, and suggests trying again later. Where possible, extract and display the canister ID in the user-friendly message without exposing sensitive data.",
      "reqIds": [
        "REQ-32"
      ],
      "version": 1
    },
    {
      "id": "feature-keep-the-ability-to-share-diagnostics-without-forcing-users-to-read-them-ensure-the-copy-error-details-action-remains-available-even-when-error-details-are-hidden-collapsed-and-that-it-copies-the-full-raw-error-string-currently-displayed-in-the-error-details-panel",
      "title": "Keep the ability to share diagnostics without forcing users to read them: ensure the “Copy error details” action remains available even when error details are hidden/collapsed, and that it copies the full raw error string currently displayed in the error details panel.",
      "reqIds": [
        "REQ-33"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-app-never-displays-raw-replica-canister-stopped-technical-error-text-by-default-in-any-user-facing-error-ui-when-an-error-is-detected-as-a-stopped-backend-canister-condition-e-g-contains-ic0508-or-is-stopped-show-a-short-user-friendly-english-explanation-optionally-including-the-canister-id-if-present-and-keep-any-raw-technical-details-behind-an-explicit-user-action-e-g-show-error-details",
      "title": "Ensure the app never displays raw replica/canister-stopped technical error text by default in any user-facing error UI. When an error is detected as a stopped backend canister condition (e.g., contains “IC0508” or “is stopped”), show a short, user-friendly English explanation (optionally including the canister id if present) and keep any raw technical details behind an explicit user action (e.g., “Show error details”).",
      "reqIds": [
        "REQ-34"
      ],
      "version": 1
    },
    {
      "id": "feature-standardize-stopped-canister-error-classification-and-messaging-for-non-bootstrap-data-fetch-failures-by-reusing-the-existing-stopped-canister-detection-utility-frontend-src-utils-bootstraperrorclassification-ts-wherever-ui-error-messages-are-derived-from-an-error-object-e-g-inline-error-components-and-page-level-error-blocks",
      "title": "Standardize stopped-canister error classification and messaging for non-bootstrap data-fetch failures by reusing the existing stopped-canister detection utility (`frontend/src/utils/bootstrapErrorClassification.ts`) wherever UI error messages are derived from an Error object (e.g., inline error components and page-level error blocks).",
      "reqIds": [
        "REQ-35"
      ],
      "version": 1
    },
    {
      "id": "feature-keep-a-reliable-way-for-users-to-share-diagnostics-without-forcing-them-to-read-technical-details-provide-a-copy-error-details-action-for-stopped-canister-errors-and-other-errors-wherever-technical-details-are-available-and-ensure-it-copies-the-full-raw-error-string-even-when-details-are-hidden-collapsed",
      "title": "Keep a reliable way for users to share diagnostics without forcing them to read technical details: provide a “Copy error details” action for stopped-canister errors and other errors wherever technical details are available, and ensure it copies the full raw error string even when details are hidden/collapsed.",
      "reqIds": [
        "REQ-36"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-frontend-react-query-hook-to-periodically-check-backend-reachability-using-the-health-check-api-and-classify-failures-using-the-existing-stopped-canister-detection-utilities",
      "title": "Create a frontend React Query hook to periodically check backend reachability using the health-check API and classify failures using the existing stopped-canister detection utilities.",
      "reqIds": [
        "REQ-38"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-compact-backend-status-indicator-in-the-top-app-header-so-users-can-immediately-see-whether-the-backend-is-reachable-backend-online-backend-offline",
      "title": "Add a compact backend status indicator in the top app header so users can immediately see whether the backend is reachable (\"Backend online\" / \"Backend offline\").",
      "reqIds": [
        "REQ-39"
      ],
      "version": 1
    },
    {
      "id": "feature-provide-a-minimal-interaction-on-the-backend-status-indicator-to-help-users-self-diagnose-without-exposing-raw-errors-by-default",
      "title": "Provide a minimal interaction on the backend status indicator to help users self-diagnose without exposing raw errors by default.",
      "reqIds": [
        "REQ-40"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-ui-issue-where-after-the-user-clicks-any-top-navigation-tab-the-app-becomes-stuck-on-the-loading-profile-screen-ensure-that-route-navigation-does-not-trigger-a-bootstrap-loading-loop-and-that-the-app-reliably-transitions-either-to-the-requested-page-or-to-an-error-screen",
      "title": "Fix the UI issue where, after the user clicks any top navigation tab, the app becomes stuck on the “Loading profile…” screen. Ensure that route navigation does not trigger a bootstrap/loading loop and that the app reliably transitions either to the requested page or to an error screen.",
      "reqIds": [
        "REQ-41"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-karigar-wise-totals-and-order-metrics-never-show-mapped-orders-as-unassigned-when-a-matching-master-design-exists-if-an-order-s-karigarname-is-empty-missing-present-a-consistent-fallback-label-e-g-unassigned-only-when-there-is-truly-no-mapping",
      "title": "Ensure karigar-wise totals and order metrics never show mapped orders as “Unassigned” when a matching master design exists. If an order’s `karigarName` is empty/missing, present a consistent fallback label (e.g., “Unassigned”) only when there is truly no mapping.",
      "reqIds": [
        "REQ-42"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-master-design-pdf-parsing-so-the-admin-import-master-designs-flow-can-extract-design-code-genericname-karigarname-mappings-from-uploaded-pdf-files-rather-than-throwing-the-current-pdf-parsing-is-not-yet-implemented-error",
      "title": "Implement Master Design PDF parsing so the Admin “Import Master Designs” flow can extract `(design_code -> { genericName, karigarName })` mappings from uploaded PDF files, rather than throwing the current “PDF parsing is not yet implemented…” error.",
      "reqIds": [
        "REQ-43"
      ],
      "version": 1
    },
    {
      "id": "feature-enhance-the-header-backend-status-indicator-ui-to-help-users-self-diagnose-reachability-issues-by-showing-the-backend-canister-id-from-healthcheck-when-online-and-by-providing-a-clear-english-offline-explanation-plus-copy-to-clipboard-for-technical-details-when-offline",
      "title": "Enhance the header backend status indicator UI to help users self-diagnose reachability issues by showing the backend canister id (from `healthCheck`) when online, and by providing a clear, English offline explanation plus copy-to-clipboard for technical details when offline.",
      "reqIds": [
        "REQ-46"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-bootstrap-loading-error-experience-to-explicitly-direct-users-to-the-backend-status-indicator-for-quick-diagnosis-without-mentioning-supabase-and-without-exposing-raw-technical-errors-by-default",
      "title": "Update the bootstrap loading / error experience to explicitly direct users to the backend status indicator for quick diagnosis, without mentioning Supabase and without exposing raw technical errors by default.",
      "reqIds": [
        "REQ-47"
      ],
      "version": 1
    },
    {
      "id": "feature-eliminate-the-infinite-loading-profile-state-that-occurs-after-the-user-clicks-any-navigation-button-tab-by-ensuring-actor-initialization-and-bootstrap-queries-cannot-hang-or-remain-perpetually-in-a-loading-state-after-route-changes",
      "title": "Eliminate the infinite “Loading profile…” state that occurs after the user clicks any navigation button/tab by ensuring actor initialization and bootstrap queries cannot hang or remain perpetually in a loading state after route changes.",
      "reqIds": [
        "REQ-48"
      ],
      "version": 1
    },
    {
      "id": "feature-make-the-non-safe-actor-hook-frontend-src-hooks-useactor-ts-non-blocking-and-error-aware-consistent-with-the-safe-actor-behavior-so-that-initializeaccesscontrolwithsecret-cannot-trap-hang-the-app-when-a-token-is-missing-empty-invalid-and-so-failures-surface-as-explicit-error-state-not-perpetual-isfetching",
      "title": "Make the non-safe actor hook (`frontend/src/hooks/useActor.ts`) non-blocking and error-aware, consistent with the safe actor behavior, so that `_initializeAccessControlWithSecret(...)` cannot trap/hang the app when a token is missing/empty/invalid and so failures surface as explicit error state (not perpetual `isFetching`).",
      "reqIds": [
        "REQ-49"
      ],
      "version": 1
    },
    {
      "id": "feature-prevent-route-level-pages-and-data-hooks-from-re-triggering-bootstrap-hangs-by-avoiding-use-of-the-unsafe-actor-hook-for-authenticated-data-fetching-update-react-query-hooks-in-frontend-src-hooks-usequeries-ts-to-use-the-safe-actor-pathway-or-the-updated-error-aware-useactor-so-actor-init-failures-cannot-cascade-into-navigation-induced-loading-loops",
      "title": "Prevent route-level pages and data hooks from re-triggering bootstrap hangs by avoiding use of the unsafe actor hook for authenticated data fetching; update React Query hooks in `frontend/src/hooks/useQueries.ts` to use the safe actor pathway (or the updated error-aware `useActor`) so actor init failures cannot cascade into navigation-induced loading loops.",
      "reqIds": [
        "REQ-50"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-master-designs-imported-from-excel-correctly-capture-the-karigar-factory-name-by-expanding-excel-column-header-matching-to-include-common-variations-e-g-factory-factory-name-karigar-factory-karigar-factory-etc-so-that-saved-master-design-entries-contain-the-expected-karigarname-value-instead-of-defaulting-to-a-fallback-due-to-an-unrecognized-column",
      "title": "Ensure Master Designs imported from Excel correctly capture the Karigar/Factory name by expanding Excel column header matching to include common variations (e.g., \"factory\", \"factory_name\", \"karigar/factory\", \"karigar_factory\", etc.), so that saved master design entries contain the expected `karigarName` value instead of defaulting to a fallback due to an unrecognized column.",
      "reqIds": [
        "REQ-51"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-master-design-excel-import-parsing-so-the-karigar-factory-name-column-is-correctly-detected-and-saved-into-masterdesignentry-karigarname-when-headers-use-variants-like-karigar-factory-name-normalized-forms-like-karigar-factory-name",
      "title": "Fix Master Design Excel import parsing so the \"Karigar/Factory Name\" column is correctly detected and saved into `MasterDesignEntry.karigarName` when headers use variants like \"KARIGAR/FACTORY NAME\" (normalized forms like `karigar_factory_name`).",
      "reqIds": [
        "REQ-53"
      ],
      "version": 1
    },
    {
      "id": "feature-expand-master-design-excel-import-header-alias-matching-so-that-design-code-and-karigar-factory-columns-are-detected-for-common-headers-seen-in-the-provided-data-including-at-minimum-design-name-normalized-design-name-for-design-code-and-karigar-factory-name-normalized-karigar-factory-name-for-karigar-factory",
      "title": "Expand Master Design Excel import header alias matching so that Design Code and Karigar/Factory columns are detected for common headers seen in the provided data, including at minimum: \"DESIGN NAME\" (normalized `design_name`) for design code, and \"KARIGAR/FACTORY NAME\" (normalized `karigar_factory_name`) for karigar/factory.",
      "reqIds": [
        "REQ-54"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-clear-user-facing-warning-in-the-master-design-import-flow-when-the-karigar-factory-column-is-not-detected-and-the-parser-will-default-karigarname-to-unassigned-for-some-or-all-rows",
      "title": "Add a clear, user-facing warning in the Master Design import flow when the karigar/factory column is not detected and the parser will default `karigarName` to \"Unassigned\" for some or all rows.",
      "reqIds": [
        "REQ-55"
      ],
      "version": 1
    },
    {
      "id": "feature-normalize-design-code-strings-consistently-during-mapping-so-that-minor-formatting-differences-between-orders-and-master-designs-leading-trailing-spaces-repeated-internal-spaces-do-not-prevent-automatic-karigar-assignment",
      "title": "Normalize design code strings consistently during mapping so that minor formatting differences between Orders and Master Designs (leading/trailing spaces, repeated internal spaces) do not prevent automatic karigar assignment.",
      "reqIds": [
        "REQ-56"
      ],
      "version": 1
    },
    {
      "id": "feature-add-standardize-a-single-shared-normalization-rule-for-design-code-matching-on-the-frontend-mapping-utilities-used-during-ingestion-preview-and-ui-only-mapping-so-the-preview-and-any-client-side-mapping-behavior-matches-backend-behavior-and-does-not-show-false-unassigned-unmapped-states-due-to-whitespace-differences",
      "title": "Add/standardize a single shared normalization rule for Design Code matching on the frontend mapping utilities used during ingestion preview and UI-only mapping, so the preview and any client-side mapping behavior matches backend behavior and does not show false “Unassigned”/unmapped states due to whitespace differences.",
      "reqIds": [
        "REQ-58"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-user-facing-karigar-labeling-in-dashboards-tables-never-displays-a-mapped-order-as-unassigned-when-a-matching-master-design-exists-the-label-unassigned-should-only-be-used-when-the-backend-truly-stores-an-empty-whitespace-karigarname-or-the-order-is-genuinely-unmapped",
      "title": "Ensure user-facing karigar labeling in dashboards/tables never displays a mapped order as “Unassigned” when a matching master design exists. The label “Unassigned” should only be used when the backend truly stores an empty/whitespace karigarName (or the order is genuinely unmapped).",
      "reqIds": [
        "REQ-59"
      ],
      "version": 1
    },
    {
      "id": "feature-when-displaying-the-complete-orders-list-in-the-ui-ensure-similar-designs-are-shown-together-by-sorting-orders-design-wise-primary-sort-by-designcode-secondary-sort-by-orderno-while-keeping-all-existing-filters-working-apply-this-consistently-anywhere-the-full-orders-list-is-displayed-admin-dashboard-all-orders-staff-dashboard-orders-table-and-karigar-assigned-orders",
      "title": "When displaying the complete orders list in the UI, ensure similar designs are shown together by sorting orders design-wise (primary sort by `designCode`, secondary sort by `orderNo`), while keeping all existing filters working. Apply this consistently anywhere the full orders list is displayed (Admin Dashboard \"All Orders\", Staff Dashboard Orders table, and Karigar \"Assigned Orders\").",
      "reqIds": [
        "REQ-63"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-pdf-order-parsing-for-daily-orders-so-that-orders-are-assigned-to-the-correct-karigar-based-on-the-pdf-s-layout-rule-when-a-karigar-factory-name-appears-in-the-pdf-all-subsequent-order-rows-belong-to-that-karigar-until-the-next-karigar-factory-name-appears",
      "title": "Implement PDF order parsing for Daily Orders so that orders are assigned to the correct karigar based on the PDF’s layout rule: when a karigar/factory name appears in the PDF, all subsequent order rows belong to that karigar until the next karigar/factory name appears.",
      "reqIds": [
        "REQ-65"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-ingestion-preview-mapping-flow-so-that-pdf-derived-karigar-assignment-is-preserved-and-visible-in-the-preview-tables-while-still-supporting-master-design-mapping-for-genericname-and-unmapped-design-code-detection",
      "title": "Update the ingestion preview/mapping flow so that PDF-derived karigar assignment is preserved and visible in the preview tables, while still supporting master-design mapping for `genericName` and unmapped design-code detection.",
      "reqIds": [
        "REQ-66"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-pdf-order-parsing-logic-so-that-karigar-assignment-matches-the-uploaded-pdf-s-structure-when-a-karigar-name-header-appears-in-the-pdf-all-subsequent-order-rows-must-be-assigned-to-that-karigar-until-the-next-karigar-name-header-appears-even-if-the-header-line-does-not-contain-explicit-keywords-like-karigar-or-factory",
      "title": "Update the PDF order parsing logic so that karigar assignment matches the uploaded PDF’s structure: when a karigar name header appears in the PDF, all subsequent order rows must be assigned to that karigar until the next karigar name header appears (even if the header line does not contain explicit keywords like \"KARIGAR\" or \"FACTORY\").",
      "reqIds": [
        "REQ-68"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-ingestion-preview-clearly-reflects-the-pdf-derived-karigar-assignment-so-staff-admin-can-verify-that-karigarname-is-being-applied-from-the-pdf-before-uploading",
      "title": "Ensure the ingestion preview clearly reflects the PDF-derived karigar assignment so Staff/Admin can verify that karigarName is being applied from the PDF before uploading.",
      "reqIds": [
        "REQ-69"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-pdf-excel-ingestion-assigns-and-displays-orders-karigar-wise-based-on-design-code-mapping-even-when-master-designs-are-still-loading-at-the-moment-the-file-is-parsed-specifically-1-parsing-a-file-must-not-produce-a-preview-where-mapped-orders-incorrectly-appear-as-unmapped-unassigned-simply-because-usegetmasterdesigns-has-not-returned-yet-2-once-master-designs-load-the-ingestion-preview-must-re-apply-master-design-mapping-to-the-already-parsed-orders-so-the-expected-karigarname-appears-3-keep-the-existing-behavior-that-preserves-non-empty-karigarname-extracted-from-the-pdf-do-not-overwrite-it-with-master-design-karigarname-while-still-filling-genericname-from-master-designs-when-available",
      "title": "Ensure PDF/Excel ingestion assigns and displays orders karigar-wise based on Design Code mapping, even when Master Designs are still loading at the moment the file is parsed. Specifically: (1) parsing a file must not produce a preview where mapped orders incorrectly appear as Unmapped/Unassigned simply because `useGetMasterDesigns()` has not returned yet; (2) once master designs load, the ingestion preview must re-apply master-design mapping to the already-parsed orders so the expected `karigarName` appears; (3) keep the existing behavior that preserves non-empty `karigarName` extracted from the PDF (do not overwrite it with master-design karigarName), while still filling `genericName` from master designs when available.",
      "reqIds": [
        "REQ-71"
      ],
      "version": 1
    },
    {
      "id": "feature-make-karigar-wise-filtering-in-the-orders-list-behave-predictably-for-admin-staff-the-karigar-filter-dropdown-must-reflect-the-same-karigar-names-that-will-be-used-for-filtering-and-selecting-a-karigar-must-show-all-orders-assigned-to-that-karigar-if-orders-are-mapped-to-a-karigar-via-master-designs-after-ingestion-they-must-no-longer-appear-under-unassigned-in-the-staff-admin-orders-filter-list-and-filtered-results",
      "title": "Make karigar-wise filtering in the Orders list behave predictably for Admin/Staff: the Karigar filter dropdown must reflect the same karigar names that will be used for filtering, and selecting a karigar must show all orders assigned to that karigar. If orders are mapped to a karigar via master designs after ingestion, they must no longer appear under \"Unassigned\" in the Staff/Admin orders filter list and filtered results.",
      "reqIds": [
        "REQ-72"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Implement Supabase Postgres schema + auth with role-based access (Admin/Staff/Karigar) and row-level security so karigars only see assigned orders",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Master Designs management: import via Excel/PDF and manual CRUD mapping of design_code -> generic_name + karigar_name; flag unmapped design codes on ingestion",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Daily order ingestion: upload Excel and/or PDF, parse required fields (order no/type/design/weight/size/qty/remarks), auto-map from master_designs, persist to orders table",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "CO detection & highlighting: detect order_type containing “CO”, set is_customer_order=true and visually highlight rows in UI and reports",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Dashboards: Admin metrics (totals, karigar-wise totals, filters), Staff upload + filters, Karigar view of assigned orders with status updates (Received/In Progress/Completed)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Filtering/grouping: karigar-wise grouping, sortable by date, filters by CO, status, date range across relevant views",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Export features: karigar-wise sheet export, CO-only export, daily sheet export, cumulative database export (Admin/Staff)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Offline-first PWA: installable mobile-friendly UI, local storage caching for offline work, background sync when online, and duplicate upload prevention",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "UI requirements: clean modern jewellery-business dashboard layout with light/dark mode and mobile responsiveness",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Create persistent backend data models and APIs for: (1) Master Design mappings (design_code -> generic_name + karigar_name, with active flag) and (2) Orders (order_no, order_type, design_code, generic_name, karigar_name, weight, size, qty, remarks, status, is_customer_order, upload_date, created_at, plus metadata needed for deduplication).",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Initial Admin bootstrap + user management: first login must be Admin; Admin can create/manage profiles for other logins (Staff/Karigar) and assign roles",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Fix backend profile/admin-check APIs so authenticated users do not get trapped during app bootstrap (which keeps the UI stuck on “Loading profile…”). Specifically, ensure `getCallerUserProfile` can be called by Admins and returns `null` when no profile exists, rather than trapping due to missing `#user` permission.",
      "reqIds": [
        "REQ-17"
      ],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Update actor initialization so failing `_initializeAccessControlWithSecret(...)` cannot block app startup. In `frontend/src/hooks/useActor.ts`, ensure actor creation resolves even if `_initializeAccessControlWithSecret` throws (e.g., missing/invalid token), and surface initialization failure to the UI via React Query error state rather than keeping `isFetching` stuck.",
      "reqIds": [
        "REQ-19"
      ],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Make Excel/PDF order ingestion resilient to unmapped design codes: do not fail parsing/ingestion; ingest those rows and show them separately (e.g., Unmapped Codes list) for later mapping",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Fix Admin dashboard/navigation UI on laptop/PC: sidebar/menu items (Dashboard, Master Designs, Users, Ingest Order, Unmapped Codes) should render and be usable responsively on desktop browsers when opened via link",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "Update bootstrap error UX so the app never shows raw stopped-canister/replica errors by default; instead show a clean user-friendly message with Retry/Logout and keep full technical details behind an explicit action (and copy-to-clipboard)",
      "reqIds": [
        "REQ-28",
        "REQ-29",
        "REQ-31",
        "REQ-32",
        "REQ-33"
      ],
      "status": "in_progress"
    },
    {
      "id": "AR-19",
      "summary": "Add a small UI status indicator (e.g., in dashboard header) showing backend reachability/health (Backend online/offline) so users can immediately tell when the backend canister is stopped/unreachable",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-20",
      "summary": "Add a lightweight backend health-check API that can be called without authentication to determine whether the backend canister is reachable.",
      "reqIds": [
        "REQ-37"
      ],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Ensure Orders are automatically assigned a karigar_name from Master Designs (including PDF-imported mappings) during ingestion/reprocessing, and dashboards/totals never show mapped orders as “Unassigned” when a matching design_code exists",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Guarantee that orders are automatically assigned `genericName` and `karigarName` from the backend Master Designs mapping based on `designCode` during upload and during unmapped-order reprocessing. Do not rely on the frontend to pre-fill these fields for correctness.",
      "reqIds": [
        "REQ-44"
      ],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Remove legacy Internet Computer (IC) canister/actor bootstrap code and replace it with a clean Supabase-based bootstrap so the app no longer hangs on “Loading profile…” trying to reach non-existent icp0.io endpoints",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-27",
      "summary": "Update the backend `healthCheck` API to return the actual backend canister id (not a placeholder), so the frontend can display accurate diagnostics when the backend is unreachable.",
      "reqIds": [
        "REQ-45"
      ],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Guarantee automatic assignment of `genericName` and `karigarName` on the backend during order upload by always deriving those fields from the stored Master Designs mapping for the order’s `designCode` (and not trusting any `genericName`/`karigarName` values supplied by the frontend). If a master design entry is inactive (`isActive=false`) or missing for a design code, treat the order as unmapped and store it in the unmapped workflow.",
      "reqIds": [
        "REQ-52"
      ],
      "status": "pending"
    },
    {
      "id": "AR-30",
      "summary": "Normalize Design Code strings consistently in the backend wherever master designs are stored or looked up, so minor formatting differences (leading/trailing spaces, repeated internal spaces) do not prevent automatic mapping of orders to (genericName, karigarName). This must ensure that an order with a design code that visually matches a Master Design entry (as in the uploaded screenshots) is assigned the correct karigarName and does not appear as “Unassigned” solely due to whitespace/formatting differences.",
      "reqIds": [
        "REQ-57"
      ],
      "status": "pending"
    },
    {
      "id": "AR-33",
      "summary": "If the project has existing persisted Master Designs or Orders in state, add a conditional Motoko state migration to re-key existing stored master design map keys (and any related lookup keys, if applicable) to the normalized design code format, so existing data benefits from the normalization fix after upgrade.",
      "reqIds": [
        "REQ-60"
      ],
      "status": "pending"
    },
    {
      "id": "AR-34",
      "summary": "When displaying the complete orders list, group/show similar designs together by sorting orders design-wise (e.g., sort/group by design_code so identical designs appear adjacent)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-35",
      "summary": "Fix backend-side Master Design mapping so that uploaded orders reliably receive the correct `genericName` and `karigarName` based on `designCode`, including when `designCode` contains extra/irregular whitespace (e.g., leading/trailing spaces or repeated internal spaces). The backend must apply one shared normalization rule for design codes everywhere it stores or looks up master designs (saving master designs, uploading orders, and reprocessing unmapped orders).",
      "reqIds": [
        "REQ-61"
      ],
      "status": "pending"
    },
    {
      "id": "AR-36",
      "summary": "Add a conditional Motoko state migration so that, on upgrade, any existing persisted Master Design keys are re-keyed to the new normalized design code format (and unmapped entries are reprocessed afterward), so previously imported master designs benefit from the mapping fix without requiring re-import.",
      "reqIds": [
        "REQ-62"
      ],
      "status": "pending"
    },
    {
      "id": "AR-38",
      "summary": "Ensure backend `getOrders()` returns orders in a deterministic design-wise order (sorted by `designCode`, then `orderNo`) so that order grouping is consistent across clients and refreshes (and not dependent on map iteration order).",
      "reqIds": [
        "REQ-64"
      ],
      "status": "pending"
    },
    {
      "id": "AR-37",
      "summary": "Implement karigar assignment logic to match the provided PDF’s mapping behavior (orders should be assigned to the subsequent karigar name as shown in the PDF), replacing the current incorrect/unassigned output",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-41",
      "summary": "Update backend order upload mapping behavior so that when `uploadParsedOrders` receives an order with a non-empty `karigarName`, the backend does not overwrite that karigar assignment with the master-design `karigarName`; it should still use master designs to fill `genericName` when available and keep the order mapped/active behavior consistent.",
      "reqIds": [
        "REQ-67"
      ],
      "status": "pending"
    },
    {
      "id": "AR-44",
      "summary": "Confirm backend upload behavior preserves non-empty karigarName provided by the PDF parse: when `uploadParsedOrders` receives an order with a non-empty `karigarName`, the backend must store that value and must not overwrite it during master-design mapping (it may still fill `genericName` from Master Designs when mapped/active).",
      "reqIds": [
        "REQ-70"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "KarigarFlow – Jewellery Order Management System",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}